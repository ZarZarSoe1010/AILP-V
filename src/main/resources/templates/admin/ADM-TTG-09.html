<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
    <title>Table - Brand</title>
    <link rel="stylesheet" href="../assets/bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i&amp;display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Alatsi&amp;display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Anek+Bangla&amp;display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Anek+Kannada&amp;display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Average+Sans&amp;display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=EB+Garamond&amp;display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inria+Sans&amp;display=swap" />
    <link rel="stylesheet" href="../assets/fonts/fontawesome-all.min.css" />
    <link rel="stylesheet" href="../assets/fonts/font-awesome.min.css" />
    <link rel="stylesheet" href="../assets/fonts/ionicons.min.css" />
    <link rel="stylesheet" href="../assets/fonts/material-icons.min.css" />
    <link rel="stylesheet" href="../assets/fonts/fontawesome5-overrides.min.css" />
    <link rel="stylesheet" href="../assets/css/Dark-footer-with-social-media-icons.css" />
    <link rel="stylesheet" href="../assets/css/dh-header-cover-image-button.css" />
    <link rel="stylesheet" href="../assets/css/Footer-Dark-Multi-Column.css" />
</head>

<body id="page-top">
    <div id="wrapper">
        <!-- this is where side bar is -->
        <div th:insert="/admin/admin-fragments :: sidebar" />

        <div class="d-flex flex-column" id="content-wrapper">
            <div id="content">
                <!-- this is where nav bar is -->
                <div th:insert="/admin/admin-fragments :: navbar" />

                <div id="teacher-grid">
                    <div class="container-fluid">
                        <!-- this is where i write grid -->
                        <select v-model="batch" class="form-select" aria-label="Default select example"
                            style="width: 12rem;">
                            <option selected disabled>Choose One Batch</option>
                            <span th:each="batch : ${batchList}">
                                <option th:value="${batch?.id}">[[${batch?.name}]]</option>
                            </span>
                        </select>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Teacher Id</th>
                                    <th>Teacher Name</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(inputField, index) in inputFields" :key="index">
                                    <td>
                                        <input v-model="inputField.id" class="form-control" type="text"
                                            placeholder="id" />
                                    </td>
                                    <td>
                                        <input v-model="inputField.name" class="form-control" type="text"
                                            placeholder="name" />
                                    </td>
                                    <td class="d-flex flex-lg-wrap">
                                        <button @click.prevent="handleRemoveField(index)"
                                            class="btn btn-danger m-1">-</button>
                                        <button @click.prevent="handleAddField()" class="btn btn-success m-1">+</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="d-flex justify-content-start ms-2">
                            <button @click.prevent="handleSend()" class="btn btn-primary d-flex d-lg-flex"
                                style="width: 67px; padding-left: 16px;">Add</button>
                        </div>
                    </div>
                </div>

            </div>
            <footer class="bg-white sticky-footer">
                <div class="container my-auto">
                    <div class="text-center my-auto copyright"><span>Copyright Â© Brand 2022</span></div>
                </div>
            </footer>
        </div><a class="border rounded d-inline scroll-to-top" href="#page-top"><i class="fas fa-angle-up"></i></a>
    </div>

    <div th:insert="/admin/admin-fragments :: footer" />

    <script>
        const app = Vue.createApp({
            data() {
                return {
                    batch: 'Choose One Batch',
                    inputFields: [
                        { id: '', name: '', batch: '' },
                    ],
                }
            },
            methods: {
                handleAddField() {
                    this.inputFields = [...this.inputFields, { id: '', name: '', batch: '' }];
                },
                handleRemoveField(index) {
                    if (this.inputFields.length > 1) {
                        const values = [...this.inputFields];
                        values.splice(index, 1);
                        this.inputFields = values;
                    }
                },
                handleSend() {

                    this.inputFields.forEach(element => {
                        if (
                            element.id.replace(/\s/g, "").length == 0 ||
                            element.name.replace(/\s/g, "").length == 0
                        ) {

                            Swal.fire(
                                'Please Fill All Teacher Inputs!',
                                '',
                                'info'
                            )
                        }
                        else if (this.batch == "Choose One Batch") {
                            Swal.fire(
                                'Please Choose One Batch!',
                                '',
                                'info'
                            )
                        } else {
                            let data = [];
                            this.inputFields.forEach(teacher => {
                                data = [...data, { id: teacher.id, name: teacher.name, batchId: this.batch }];
                            });
                            axios
                                .post('http://localhost:8080/api/teacher/addTeachers', data)
                                .then(() => {
                                    Swal.fire(
                                        'Successfully Registered!',
                                        '',
                                        'success'
                                    ).then(() => window.location = "http://localhost:8080/admin/teacher-table");
                                })
                                .catch(error => console.log(error));
                        }
                    });

                }
            },
        });

        app.mount('#teacher-grid');
    </script>
</body>

</html>